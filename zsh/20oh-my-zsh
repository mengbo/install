#!/bin/sh -v

[ -f ~/.zshrc ] && cp ~/.zshrc ~/.zshrc.orig
cat > ~/.zshrc << EOF
# ~/.zshrc

if [ -f /etc/zshrc ]; then
    source /etc/zshrc
fi

PATH="~/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

if [ "`id -u`" -eq 0 ]; then
    PATH="\$PATH:~/bin"
else
    PATH="~/bin:\$PATH"
fi

if [ -d /opt/X11/bin ]; then
    PATH="\$PATH:/opt/X11/bin"
fi

if [ -d ~/.profile.d ]; then
    for i in ~/.profile.d/*.zsh ~/.profile.d/*.sh; do
        if [ -r \$i ]; then
          source \$i
        fi
    done
    unset i
fi
EOF
mkdir -p ~/.profile.d


rm -rf ~/.oh-my-zsh
git clone git://github.com/robbyrussell/oh-my-zsh.git ~/.oh-my-zsh
cat > ~/.profile.d/oh-my-zsh.zsh << EOF
export ZSH=/Users/meng/.oh-my-zsh
ZSH_THEME="ys"
plugins=(git nvm pyenv rbenv thefuck vi-mode)

EOF

git clone git://github.com/zsh-users/zsh-autosuggestions \
	~/.oh-my-zsh/custom/plugins/zsh-autosuggestions
cat >> ~/.profile.d/oh-my-zsh.zsh << EOF
# zsh-autosuggestions
plugins+=(zsh-autosuggestions)

EOF

git clone git://github.com/zsh-users/zsh-completions \
	~/.oh-my-zsh/custom/plugins/zsh-completions
cat >> ~/.profile.d/oh-my-zsh.zsh << EOF
# zsh-completions
plugins+=(zsh-completions)
autoload -U compinit && compinit

EOF

git clone git://github.com/zsh-users/zsh-syntax-highlighting.git \
	~/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting
cat >> ~/.profile.d/oh-my-zsh.zsh << EOF
# zsh-syntax-highlighting
plugins+=(zsh-syntax-highlighting history-substring-search)

EOF

cat >> ~/.profile.d/oh-my-zsh.zsh << EOF

source \$ZSH/oh-my-zsh.sh
EOF
